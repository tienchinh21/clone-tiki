(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[185],{ePid:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return g}));var n=r("etRO"),a=r("4jfz"),o=r("mHfP"),c=r("1U+3"),i=r("DY1Z"),u=r("5UAf"),l=r("mXGw"),s=r("xEuF"),d=r("Jzau"),f=r("wlaf"),p=r("a1Hr"),v=r("y1FF");function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(c.a)(this,r)}}var g=function(e){Object(o.a)(r,e);var t=b(r);function r(){var e;Object(n.a)(this,r);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={ready:!1},e.trackityIndentify=function(){var t=e.props.customer,r=t.email,n=t.id;r&&n&&Object(v.a)({email:r,id:n})},e}return Object(a.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.delaySDK,r=void 0===t||t;localStorage.getItem(s.b)||Object(s.f)(!1),this.interval=setInterval((function(){"complete"===window.document.readyState&&(setTimeout((function(){e.setState({ready:!0});var t=e.props.customer;null===t||void 0===t||t.id;Object(f.a)(),Object(p.a)(),Object(d.a)(),e.props.customer&&(Object(p.b)(t,e.props.route),Object(d.b)({userId:t}),e.trackityIndentify())}),r?3e3:0),e.interval&&clearInterval(e.interval))}),100)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"componentDidUpdate",value:function(e){var t;!e.customer&&this.props.customer&&(Object(p.b)(this.props.customer,this.props.route),this.trackityIndentify(),Object(u.c)(null===(t=this.props.customer)||void 0===t?void 0:t.id))}},{key:"render",value:function(){return null}}]),r}(l.Component)},uEoR:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("7CRm");var a=r("UMlT"),o=r("qghH");function c(e,t){return Object(n.a)(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(u){a=!0,o=u}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}(e,t)||Object(a.a)(e,t)||Object(o.a)()}},wlaf:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){try{window.fbAsyncInit=function(){var e;FB.init({appId:"220558114759707",autoLogAppEvents:!0,xfbml:!0,version:"v3.1"}),null!==(e=window)&&void 0!==e&&e.FBSDK&&(window.FBSDK.map((function(e){return e()})),window.FBSDK={},window.FBSDK.push=function(e){return e()})},function(e,t,r){var n,a=e.getElementsByTagName(t)[0];e.getElementById(r)||((n=e.createElement(t)).id=r,n.src="https://connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(n,a))}(document,"script","facebook-jssdk")}catch(e){console.log("FACEBOOK",e)}}},xEuF:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return y})),r.d(t,"g",(function(){return m})),r.d(t,"f",(function(){return h})),r.d(t,"e",(function(){return O}));var n=r("/dBk"),a=r.n(n),o=r("uEoR"),c=r("qd51"),i=r("edSL"),u=r.n(i),l=r("8qar"),s=r.n(l),d=r("cph9"),f=r("RQuD"),p="delivery_zone",v="delivery-zone",b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,r){return navigator.geolocation.getCurrentPosition(t,r,e)}))},g=function(e){var t=e.replace(/Qu\u1eadn/g,"Q.");return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/qu\u1eadn/g,"Q.")).replace(/Ph\u01b0\u1eddng/g,"P.")).replace(/ph\u01b0\u1eddng/g,"P.")).replace(/Th\xe0nh Ph\u1ed1/g,"TP.")).replace(/Th\xe0nh ph\u1ed1/g,"TP.")).replace(/Th\u1ecb x\xe3/g,"TX.")).replace(/X\xe3/g,"X.")).replace(/x\xe3/g,"X.")).replace(/Th\u1ecb tr\u1ea5n/g,"TT.")).replace(/Huy\u1ec7n/g,"H.")},y=function(){try{var e=localStorage.getItem(v);if(!e)return null;var t=JSON.parse(e),r=d.a.get(p);return u()(t,"data.delivery_zone")===r&&parseInt((new s.a).format("X"))-u()(t,"create_at",0)<=3600?t:(d.a.remove(p),localStorage.removeItem(v),null)}catch(n){return null}},m=function(){var e=Object(c.a)(a.a.mark((function e(t){var r,n,c,i,l,s,b,g,m,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=y()){e.next=24;break}if(n=void 0,c=void 0,!t){e.next=12;break}return e.next=8,Object(f.a)([{url:"/v2/me/delivery_zone",method:"get"},{url:"/v2/me/address?limit=10000",method:"get"}]);case 8:i=e.sent,l=Object(o.a)(i,2),n=l[0],c=l[1];case 12:if(!n||!n.data){e.next=18;break}return s=n.data,r={create_at:(new Date).getTime(),data:s},localStorage.setItem(v,JSON.stringify(r)),d.a.set(p,s.delivery_zone),e.abrupt("return",s);case 18:if(!c||!c.data){e.next=24;break}return m=(null===(b=c.data)||void 0===b||null===(g=b.data)||void 0===g?void 0:g.find((function(e){return!0===e.is_default})))||{},r={create_at:(new Date).getTime(),data:m},localStorage.setItem(v,JSON.stringify(r)),d.a.set(p,m.delivery_zone),e.abrupt("return",m);case 24:return h=u()(r,"data"),e.abrupt("return",h);case 28:return e.prev=28,e.t0=e.catch(0),console.log("LOCATION",e.t0),e.abrupt("return",null);case 32:case"end":return e.stop()}}),e,null,[[0,28]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(c.a)(a.a.mark((function e(){var t,r,n,o,c,i,l,s,g,m=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(m.length>0&&void 0!==m[0])||m[0],r={},e.prev=2,e.next=5,Object(f.a)({url:"https://api.tiki.vn/delivery/api/v2/location-detection"});case 5:if(n=e.sent,(o=u()(n,"data.data"))&&o.delivery_zone){e.next=10;break}return console.error("Cannot detect user location."),e.abrupt("return");case 10:if(r={create_at:(new Date).getTime(),data:o},y()||(localStorage.setItem(v,JSON.stringify(r)),d.a.set(p,o.delivery_zone)),!t||!navigator.geolocation){e.next=30;break}return e.next=16,b({enableHighAccuracy:!1});case 16:if(c=e.sent,i=u()(c,"coords.latitude"),l=u()(c,"coords.longitude"),!i||!l){e.next=30;break}return e.next=22,Object(f.a)({url:"/shopping/v1/location-detection",params:{latitude:i,longitude:l}});case 22:if(s=e.sent,(g=u()(s,"data.data"))&&g.delivery_zone){e.next=27;break}return console.error("Cannot detect user location."),e.abrupt("return");case 27:r={create_at:(new Date).getTime(),data:g},localStorage.setItem(v,JSON.stringify(r)),d.a.set(p,g.delivery_zone);case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(2),console.error("User automatic location error occurred",e.t0);case 35:return e.abrupt("return",r.data);case 36:case"end":return e.stop()}}),e,null,[[2,32]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(c.a)(a.a.mark((function e(){var t,r,n,o,c,i,l,s,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.geolocation){e.next=24;break}return e.prev=1,e.next=4,b({enableHighAccuracy:!1});case 4:if(t=e.sent,r=u()(t,"coords.latitude"),n=u()(t,"coords.longitude"),!r||!n){e.next=17;break}return e.next=10,Object(f.a)({url:"https://api.tiki.vn/delivery/api/v2/location-detection",params:{latitude:r,longitude:n}});case 10:if(o=e.sent,(c=u()(o,"data.data"))&&c.delivery_zone){e.next=15;break}return console.error("Cannot detect user location."),e.abrupt("return");case 15:return i={create_at:(new Date).getTime(),data:c},e.abrupt("return",i.data);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(1),console.error("User automatic location error occurred",e.t0);case 22:e.next=38;break;case 24:return e.prev=24,e.next=27,Object(f.a)({url:"https://api.tiki.vn/delivery/api/v2/location-detection"});case 27:if(l=e.sent,(s=u()(l,"data.data"))&&s.delivery_zone){e.next=32;break}return console.error("Cannot detect user location."),e.abrupt("return");case 32:return d={create_at:(new Date).getTime(),data:s},e.abrupt("return",d.data);case 36:e.prev=36,e.t1=e.catch(24);case 38:case"end":return e.stop()}}),e,null,[[1,19],[24,36]])})));return function(){return e.apply(this,arguments)}}()}}]);